(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7e14d622"],{2089:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("h1",[t._v("创建时间模板")]),i("div",{staticClass:"timecontainer"},[i("div",{staticStyle:{width:"100%"}},[i("el-button",{staticClass:"toggle-all-btn",attrs:{size:"small",type:"primary",plain:""}},[t._v("全部投放")])],1),i("div",[i("div",{staticClass:"timeweek",staticStyle:{"border-top":"1px solid #ddd"}},[t._v("星期\\时间")]),t._l(t.numData,(function(e){return i("div",{staticClass:"timehours",style:23==e?"border-right:1px solid #ddd;border-top:1px solid #ddd;":"border-top:1px solid #ddd;"},[t._v(t._s(e))])}))],2),i("div",{staticStyle:{clear:"both"}}),t._l(t.timeData,(function(e,s){return i("div",[i("div",{staticClass:"timeweek"},[t._v(t._s(e.date))]),t._l(e.discount,(function(e,s){return i("div",{staticClass:"select-item",class:t.getColorClass(e),style:23==s?"border-right:1px solid #ddd":"",attrs:{"data-discount":e}},[t._v(" ")])})),i("div",{staticStyle:{clear:"both"}})],2)})),i("div",{staticStyle:{clear:"both"}}),i("div",{staticClass:"tip-box-dashed"})],2),i("div",[i("el-form",{ref:"tplForm",attrs:{model:t.tplForm,rules:t.rules}},[i("el-form-item",{attrs:{prop:"name"}},[t._v("模板名称："),i("el-input",{model:{value:t.tplForm.name,callback:function(e){t.$set(t.tplForm,"name",e)},expression:"tplForm.name"}})],1),i("el-button",{attrs:{type:"primary",loading:t.tplForm.submitBtnLoading},on:{click:function(e){return t.submitForm("tplForm")}}},[t._v("立即保存")]),i("el-button",{on:{click:function(e){return t.resetForm("tplForm")}}},[t._v("重置")])],1)],1),i("div",{staticClass:"duration_setting popups",attrs:{id:"duration_setting","bx-id":"node-741583291670663.1912node-74"}},[t._m(0),t._m(1),i("div",{staticClass:"mt5",attrs:{"bx-id":"node-901583291670663.1418node-90"}},[i("el-button",{attrs:{size:"small",type:"primary",id:"celueSubmit"}},[t._v("确定")]),t._v("   \n            "),i("el-button",{attrs:{size:"small",id:"celueCancal"}},[t._v("取消")])],1)])])},a=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("p",{staticClass:"mb10",attrs:{"bx-id":"node-751583291670663.737node-75"}},[i("span",{attrs:{id:"duration_setting_week","bx-id":"node-761583291670663.6802node-76"}},[t._v("设定投放比例")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"controls bx-controls clearfix mt10",attrs:{"bx-id":"node-781583291670663.7588node-78","data-spm-anchor-id":"a2e2i.11532895.0.i3.38ea6abby8xUeh",id:"mx_1966"}},[i("label",{staticClass:"radio fl inline",attrs:{id:"duration_setting_setdiscount","bx-id":"node-791583291670663.778node-79"}},[i("input",{attrs:{type:"radio",name:"celue",value:"def"}}),t._v("\n                自定义：\n\n                "),i("div",{staticClass:"pr fl error-right",staticStyle:{display:"inline-block"},attrs:{"bx-id":"node-811583291670663.9912node-81"}},[i("input",{staticStyle:{width:"50px",display:"inline-block"},attrs:{id:"duration_setting_discount",maxlength:"3",disabled:"true"}})]),i("span",{staticClass:"fl ml5 lh28",attrs:{"bx-id":"node-831583291670663.482node-83"}},[t._v("%")])]),i("div",{staticClass:"duration_setting_tip",staticStyle:{color:"rgb(96, 96, 96)"},attrs:{id:"duration_setting_tip","bx-id":"node-841583291670663.4382node-84"}},[t._v("范围:30-250的整数")]),i("div",{staticClass:"cb",attrs:{"bx-id":"node-851583291670663.8958node-85"}}),i("label",{staticClass:"radio clearfix mb5",attrs:{id:"duration_setting_set100","bx-id":"node-861583291670663.0408node-86","data-spm-anchor-id":"a2e2i.11532895.0.i1.38ea6abby8xUeh"}},[i("input",{attrs:{type:"radio",name:"celue",value:"100",checked:""}}),t._v(" 无折扣")]),i("div",{staticClass:"cb",attrs:{"bx-id":"node-851583291670663.8958node-85"}}),i("label",{staticClass:"radio clearfix mb5",attrs:{id:"duration_setting_setdefault","bx-id":"node-881583291670663.6536node-88","data-spm-anchor-id":"a2e2i.11532895.0.i2.38ea6abby8xUeh"}},[i("input",{attrs:{type:"radio",name:"celue",value:"0"}}),t._v(" 不投放 ")])])}],n=(i("7514"),i("7f7f"),i("1bab")),o=i("4328"),d=i.n(o),l=i("1157"),r=i.n(l),c=[{date:"星期一",discount:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{date:"星期二",discount:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{date:"星期三",discount:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{date:"星期四",discount:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{date:"星期五",discount:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{date:"星期六",discount:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{date:"星期日",discount:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}],u={data:function(){return{numData:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],timeData:c,timeData_Null:c,selectFlag:!1,max:{x:0,y:0},tplForm:{id:0,name:"",submitBtnLoading:!1},rules:{name:[{required:!0,message:"请输入模板名称",trigger:"blur"},{min:2,max:15,message:"长度在 2 到 15 个字符",trigger:"blur"}]}}},watch:{$route:function(t,e){this.loadTimeTpl()}},methods:{submitForm:function(t){var e=this;this.tplForm.submitBtnLoading=!0;var i=0,s=0,a=new Array;r()(".select-item").each((function(){"undefined"==typeof a[s]&&(a[s]=new Array),a[s].push(parseInt(r()(this).data("discount"))),i++,i>23&&(i=0,s++)}));for(var o=0;o<7;o++)this.timeData[o].discount=a[o];console.log(this.timeData),this.$refs[t].validate((function(t){if(!t)return!1;var i={id:e.tplForm.id,timeData:e.timeData,name:e.tplForm.name};Object(n["a"])({url:"/subway/SaveTimeTpl",method:"post",data:d.a.stringify(i)}).then((function(t){console.log(t),e.$message({showClose:!0,message:"保存成功",type:"success"}),e.$router.push({path:"/bat/timeApply"}),e.tplForm.submitBtnLoading=!1}))}))},resetForm:function(t){this.loadTimeTpl(),this.$refs[t].resetFields()},getColorClass:function(t){var e;return 0==t?e="":t<100?e="selected_10":100==t?e="selected":t>100&&t<200?e="selected_101":t>=200&&(e="selected_200"),e},loadTimeTpl:function(){var t=this;this.$route.query.id?Object(n["a"])({url:"/subway/GetTimeTpl",method:"get",params:{id:this.$route.query.id}}).then((function(e){console.log(e),t.timeData=JSON.parse(e.data.source_data),t.tplForm.id=t.$route.query.id,t.$set(t.tplForm,"name",e.data.tpl_name)})):(this.timeData=this.timeData_Null,this.tplForm.id=0,this.tplForm.name="")}},mounted:function(){this.loadTimeTpl();var t=function(t,e){function i(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,t.preventDefault?t.preventDefault():t.returnValue=!1}var s=r()(t);s.on("mousedown",(function(s){var a=r()('<div class="select-box-dashed"></div>');r()("h1").append(a);var n=s.x||s.clientX,o=s.y||s.clientY;a.css({left:n,top:o});var d=null,l=null;i(s),r()(t).on("mousemove",(function(e){a.css("display","block"),d=e.x||e.clientX,l=e.y||e.clientY;var s=Math.min(d,n),c=Math.min(l,o),u=Math.abs(d-n),m=Math.abs(l-o);a.css({left:s,top:c,width:u,height:m}),r()(t).find(".select-item").each((function(){var t=r()(this),e=t.prop("offsetWidth")+t.prop("offsetLeft"),i=t.prop("offsetHeight")+t.prop("offsetTop"),a=e>s,n=i>c,o=t.prop("offsetLeft")<s+u,d=t.prop("offsetTop")<c+m;a&&n&&o&&d?t.addClass("temp-selected"):t.removeClass("temp-selected")})),i(e)})),r()(document).on("mouseup",(function(){r()(t).off("mousemove"),a.remove(),r()(t).find(".select-item.temp-selected").length>0&&(r()("#duration_setting").show(),r()("#duration_setting").css("left",n+"px"),r()("#duration_setting").css("top",o+"px")),e&&e()}))})).on("click",".select-item",(function(t){s.find(".temp-selected").removeClass("temp-selected");var e=t.x||t.clientX,i=t.y||t.clientY;r()(this).addClass("temp-selected"),r()("#duration_setting").show(),r()("#duration_setting").css("left",e+"px"),r()("#duration_setting").css("top",i+"px")})).on("click",".toggle-all-btn",(function(){s.find(".select-item").removeClass("selected_10").removeClass("selected").removeClass("selected_101").removeClass("selected_200"),r()(this).attr("data-all")?(r()(this).removeAttr("data-all"),s.find(".select-item").data("discount",0).removeClass("selected")):(r()(this).attr("data-all",1),s.find(".select-item").data("discount",100).addClass("selected"))}))};t(".timecontainer"),r()("#celueSubmit").click((function(){var t,e=r()("input[name='celue']:checked").val();if("def"==e&&(e=r()("#duration_setting_discount").val(),e<30||e>250))return alert("范围在30 - 250"),!1;0==e?t="":e<100?t="selected_10":100==e?t="selected":e>100&&e<200?t="selected_101":e>=200&&(t="selected_200"),r()(".timecontainer").find(".select-item.temp-selected").data("discount",e).removeClass("selected_10").removeClass("selected").removeClass("selected_101").removeClass("selected_200").removeClass("temp-selected").addClass(t),r()("#duration_setting").hide()})),r()("#celueCancal").click((function(){r()("#duration_setting").hide(),r()(".timecontainer").find(".select-item.temp-selected").removeClass("temp-selected")})),r()("input:radio[name='celue']").click((function(){"def"==r()("input[name='celue']:checked").val()?r()("#duration_setting_discount").attr("disabled",!1):r()("#duration_setting_discount").attr("disabled",!0)})),r()(".select-item").mouseover((function(t){var e=r()(".tip-box-dashed");e.text("鼠标位置投放比例："+r()(this).data("discount")+"%")}))}},m=u,p=(i("df55"),i("2877")),f=Object(p["a"])(m,s,a,!1,null,null,null);e["default"]=f.exports},"7f7f":function(t,e,i){var s=i("86cc").f,a=Function.prototype,n=/^\s*function ([^ (]*)/,o="name";o in a||i("9e1e")&&s(a,o,{configurable:!0,get:function(){try{return(""+this).match(n)[1]}catch(t){return""}}})},"9ec1":function(t,e,i){},df55:function(t,e,i){"use strict";var s=i("9ec1"),a=i.n(s);a.a}}]);
//# sourceMappingURL=chunk-7e14d622.fcda8a7a.js.map